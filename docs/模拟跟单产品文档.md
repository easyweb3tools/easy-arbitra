# AI Agent æ¨¡æ‹Ÿè·Ÿå•ç³»ç»Ÿ â€” äº§å“è®¾è®¡æ–‡æ¡£

Last updated: 2026-02-26
Status: Design Phase

---

## 1. äº§å“å®šä¹‰

### 1.1 æ ¸å¿ƒç†å¿µ

**AI Agent ä¸»å¯¼çš„æ¨¡æ‹Ÿè·Ÿå•**ï¼šä¸æ˜¯ç®€å•å¤åˆ¶äº¤æ˜“ï¼Œè€Œæ˜¯ç”± Amazon Nova é©±åŠ¨çš„ AI Agent æ‹…ä»»"æ™ºèƒ½äº¤æ˜“åŠ©æ‰‹"è§’è‰²ã€‚Agent ç‹¬ç«‹åˆ†ææ¯ä¸€ç¬”é¢†æŠ•é’±åŒ…çš„äº¤æ˜“ï¼Œè‡ªä¸»åˆ¤æ–­æ˜¯å¦è·Ÿå•ã€ä»¥ä»€ä¹ˆä»“ä½è·Ÿå•ã€ä½•æ—¶æ­¢æŸé€€å‡ºï¼Œå¹¶ç”¨è‡ªç„¶è¯­è¨€å‘ç”¨æˆ·è§£é‡Šæ¯ä¸ªå†³ç­–ã€‚

æ ¸å¿ƒå·®å¼‚åŒ–ï¼š
- **Agent å†³ç­–ï¼Œè€Œéç›²ç›®å¤åˆ¶**ï¼šAgent ä¼šç­›é€‰ã€è¿‡æ»¤ã€è°ƒæ•´è·Ÿå•è¡Œä¸º
- **å…¨ç¨‹å¯è§£é‡Š**ï¼šæ¯ä¸€æ­¥å†³ç­–é™„å¸¦è‡ªç„¶è¯­è¨€ç†ç”±
- **é£æ§å†…ç½®**ï¼šAgent æ‰§è¡Œç”¨æˆ·è®¾å®šçš„é£æ§è§„åˆ™ï¼Œä¸»åŠ¨åœæ­¢ä¸å¥åº·è·Ÿå•
- **æ¨¡æ‹Ÿå…ˆè¡Œ**ï¼šå…ˆæ¨¡æ‹Ÿè·Ÿå•ç§¯ç´¯ track recordï¼Œç”¨æˆ·ç¡®è®¤ä¿¡ä»»åå†è€ƒè™‘å®ç›˜

### 1.2 ç”¨æˆ·æ•…äº‹

```
ä½œä¸ºä¸€ä¸ª Polymarket äº¤æ˜“è€…ï¼š
1. æˆ‘å‘ç°ä¸€ä¸ª Star çº§åˆ«é«˜åˆ†é’±åŒ…ï¼ˆSmart Score 85, Event Trader ç­–ç•¥ï¼‰
2. æˆ‘ç‚¹å‡»"AI è·Ÿå•"ï¼Œè®¾ç½®æœ€å¤§ä»“ä½ 500 USDCï¼Œé£é™©åå¥½"ä¸­ç­‰"
3. AI Agent å¼€å§‹ç›‘æ§è¯¥é’±åŒ…çš„æ¯ç¬”äº¤æ˜“
4. Agent åˆ¤æ–­æŸç¬”äº¤æ˜“å€¼å¾—è·Ÿå• â†’ æ¨¡æ‹Ÿæ‰§è¡Œï¼Œå¹¶å‘Šè¯‰æˆ‘ï¼š
   "è·Ÿå•ä¹°å…¥ Election Market Yesï¼Œä»“ä½ $50 (10%)ã€‚
    ç†ç”±ï¼šè¯¥é’±åŒ…åœ¨ Event ç±»å¸‚åœºèƒœç‡ 73%ï¼Œå½“å‰ä»·æ ¼ 0.42 æœ‰æ­£é¢„æœŸã€‚"
5. Agent åˆ¤æ–­å¦ä¸€ç¬”äº¤æ˜“ä¸å€¼å¾—è·Ÿ â†’ è·³è¿‡ï¼Œå¹¶å‘Šè¯‰æˆ‘ï¼š
   "è·³è¿‡æ­¤äº¤æ˜“ã€‚ç†ç”±ï¼šè¯¥å¸‚åœºæµåŠ¨æ€§ä¸è¶³ï¼Œé¢„æœŸæ»‘ç‚¹è¶…è¿‡ 3%ã€‚"
6. å½“é¢†æŠ•é’±åŒ…å‡ºç°å¼‚å¸¸ï¼ˆå¦‚çªç„¶å¤§é¢äºæŸï¼‰ï¼ŒAgent ä¸»åŠ¨æš‚åœè·Ÿå•å¹¶é€šçŸ¥æˆ‘
7. æˆ‘åœ¨ä»ªè¡¨ç›˜ä¸Šçœ‹åˆ°æ¨¡æ‹Ÿè·Ÿå•çš„ç´¯è®¡ PnLã€èƒœç‡ã€æ¯ç¬”äº¤æ˜“è®°å½•
```

### 1.3 äº§å“è¾¹ç•Œ

**MVP åš**ï¼š
- æ¨¡æ‹Ÿè·Ÿå•ï¼ˆçº¸ä¸Šäº¤æ˜“ï¼Œä¸æ¶‰åŠçœŸå®èµ„é‡‘ï¼‰
- AI Agent é€ç¬”åˆ†æå†³ç­–
- è·Ÿå•ç»©æ•ˆè¿½è¸ªå’Œå¯è§†åŒ–
- è‡ªç„¶è¯­è¨€å†³ç­–æ—¥å¿—

**MVP ä¸åš**ï¼š
- å®ç›˜äº¤æ˜“æ‰§è¡Œï¼ˆåæœŸæ‰©å±•ï¼‰
- å¤šé’±åŒ…ç»„åˆè·Ÿå•ä¼˜åŒ–ï¼ˆåæœŸæ‰©å±•ï¼‰
- æ­¢ç›ˆ/æ­¢æŸè‡ªåŠ¨æ‰§è¡Œï¼ˆæ¨¡æ‹Ÿç¯å¢ƒä¸‹æ ‡è®°å³å¯ï¼‰

---

## 2. AI Agent æ¶æ„

### 2.1 Agent è§’è‰²å®šä¹‰

Agent åç§°ï¼š**CopyTrader Agent**

Agent çš„èŒè´£ï¼ˆSystem Prompt æ ¸å¿ƒï¼‰ï¼š

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ Polymarket è·Ÿå•äº¤æ˜“åŠ©æ‰‹ã€‚ä½ çš„èŒè´£æ˜¯ï¼š
1. åˆ†æé¢†æŠ•é’±åŒ…çš„æ¯ä¸€ç¬”æ–°äº¤æ˜“
2. ç»“åˆè¯¥é’±åŒ…çš„å†å²è¡¨ç°ã€ç­–ç•¥ç±»å‹ã€å½“å‰å¸‚åœºçŠ¶å†µï¼Œå†³å®šæ˜¯å¦è·Ÿå•
3. å¦‚æœå†³å®šè·Ÿå•ï¼Œç¡®å®šåˆé€‚çš„ä»“ä½å¤§å°
4. å¦‚æœå†³å®šä¸è·Ÿå•ï¼Œè¯´æ˜ç†ç”±
5. æŒç»­ç›‘æ§å·²è·Ÿå•æŒä»“ï¼Œåœ¨å¿…è¦æ—¶å»ºè®®æ­¢æŸæˆ–å¹³ä»“
6. å½“é¢†æŠ•é’±åŒ…å‡ºç°å¼‚å¸¸ä¿¡å·æ—¶ï¼Œä¸»åŠ¨å‘å‡ºé£æ§è­¦å‘Š

ä½ çš„å†³ç­–å¿…é¡»ï¼š
- éµå®ˆç”¨æˆ·è®¾å®šçš„æœ€å¤§ä»“ä½å’Œé£é™©åå¥½
- ç»™å‡ºæ¸…æ™°çš„è‡ªç„¶è¯­è¨€ç†ç”±
- è¿”å›ç»“æ„åŒ– JSON ä»¥ä¾¿ç³»ç»Ÿæ‰§è¡Œ
```

### 2.2 Agent å†³ç­–æµç¨‹

```
æ–°äº¤æ˜“åˆ°è¾¾
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æ•°æ®æ”¶é›†     â”‚  é¢†æŠ•é’±åŒ…ç‰¹å¾ + äº¤æ˜“è¯¦æƒ… + å¸‚åœºä¿¡æ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. è§„åˆ™é¢„æ£€     â”‚  ç”¨æˆ·é£æ§è§„åˆ™ checkï¼ˆä»“ä½ä¸Šé™ã€æš‚åœçŠ¶æ€ç­‰ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ é€šè¿‡
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Nova Agent   â”‚  è°ƒç”¨ Amazon Nova æ¨¡å‹åˆ†æ
â”‚     åˆ†æå†³ç­–     â”‚  è¾“å…¥ï¼šäº¤æ˜“ä¸Šä¸‹æ–‡ + é’±åŒ…ç”»åƒ + å¸‚åœºæ•°æ®
â”‚                  â”‚  è¾“å‡ºï¼šå†³ç­– JSONï¼ˆè·Ÿ/ä¸è·Ÿ/ä»“ä½/ç†ç”±ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. å†³ç­–æ‰§è¡Œ     â”‚  æ¨¡æ‹Ÿæ‰§è¡Œè·Ÿå• / è®°å½•è·³è¿‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. é€šçŸ¥ç”¨æˆ·     â”‚  æ¨é€å†³ç­–ç»“æœ + ç†ç”±åˆ°äº‹ä»¶æµ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Nova Agent è°ƒç”¨æ¥å£

**è¾“å…¥ï¼ˆç»™ Agent çš„ä¸Šä¸‹æ–‡ï¼‰**ï¼š

```json
{
  "leader_wallet": {
    "wallet_id": 42,
    "address": "0x1234...abcd",
    "strategy_type": "event_trader",
    "smart_score": 85,
    "pool_tier": "star",
    "info_edge_level": "processing_edge",
    "pnl_30d": 1250.5,
    "win_rate_30d": 0.68,
    "momentum": "heating"
  },
  "new_trade": {
    "market_title": "Will X win the election?",
    "market_category": "politics",
    "outcome": "Yes",
    "action": "Buy",
    "price": 0.42,
    "size": 500,
    "market_volume": 2500000,
    "market_liquidity": 150000
  },
  "user_settings": {
    "max_position_usdc": 500,
    "risk_preference": "moderate",
    "current_exposure_usdc": 120,
    "remaining_budget_usdc": 380
  },
  "copy_history": {
    "total_copies": 15,
    "profitable_copies": 10,
    "total_pnl": 85.3,
    "avg_copy_size": 45.0
  }
}
```

**è¾“å‡ºï¼ˆAgent è¿”å›çš„å†³ç­–ï¼‰**ï¼š

```json
{
  "decision": "copy",
  "confidence": 0.82,
  "position_size_usdc": 50,
  "position_pct": 0.10,
  "reasoning": "è¯¥é’±åŒ…åœ¨æ”¿æ²»ç±»äº‹ä»¶å¸‚åœºèƒœç‡ 73%ï¼ŒSmart Score 85ã€‚å½“å‰ä»·æ ¼ 0.42 ä½äºæ¨¡å‹ä¼°å€¼ï¼Œé¢„æœŸæ­£æ”¶ç›Šã€‚å»ºè®®è·Ÿå• $50ï¼ˆå‰©ä½™é¢„ç®—çš„ 13%ï¼‰ã€‚",
  "reasoning_en": "Leader wallet has 73% win rate in political event markets with Smart Score 85. Price 0.42 is below model estimate. Recommend copying $50 (13% of remaining budget).",
  "risk_notes": ["å¸‚åœºå°†åœ¨ 14 å¤©åç»“ç®—", "æµåŠ¨æ€§å……è¶³"],
  "stop_loss_price": 0.25
}
```

æˆ–è€…è·³è¿‡å†³ç­–ï¼š

```json
{
  "decision": "skip",
  "confidence": 0.75,
  "reasoning": "è¯¥å¸‚åœºæµåŠ¨æ€§ä»… $8,000ï¼Œæ¨¡æ‹Ÿè·Ÿå•æ— æ³•åæ˜ çœŸå®æ»‘ç‚¹ã€‚æ­¤å¤–è¯¥é’±åŒ…åœ¨ä½æµåŠ¨æ€§å¸‚åœºçš„å†å²èƒœç‡ä»… 45%ã€‚",
  "reasoning_en": "Market liquidity is only $8,000. Leader wallet has only 45% win rate in low-liquidity markets.",
  "risk_notes": ["ä½æµåŠ¨æ€§é£é™©"]
}
```

### 2.4 Agent é£æ§è§„åˆ™ï¼ˆè§„åˆ™å±‚ï¼Œä¸èµ°æ¨¡å‹ï¼‰

ä»¥ä¸‹è§„åˆ™åœ¨è°ƒç”¨ Nova ä¹‹å‰ç”±ä»£ç ç¡¬æ€§æ‰§è¡Œï¼š

| è§„åˆ™ | æ¡ä»¶ | åŠ¨ä½œ |
|------|------|------|
| ä»“ä½ä¸Šé™ | å•ç¬”è·Ÿå• > ç”¨æˆ·è®¾å®šæœ€å¤§ä»“ä½çš„ 20% | æˆªæ–­åˆ° 20% |
| æ€»æš´éœ²ä¸Šé™ | å·²è·Ÿå•æ€»é¢ >= ç”¨æˆ·æœ€å¤§ä»“ä½ | æš‚åœæ–°è·Ÿå• |
| é¢†æŠ•å¼‚å¸¸ | é¢†æŠ•é’±åŒ… 30D PnL å˜è´Ÿ | æš‚åœè·Ÿå•å¹¶é€šçŸ¥ |
| é¢‘ç‡é™åˆ¶ | åŒä¸€å¸‚åœº 1 å°æ—¶å†…å·²è·Ÿå• | è·³è¿‡é‡å¤è·Ÿå• |
| æœ€å°ä»“ä½ | è®¡ç®—ä»“ä½ < $1 | è·³è¿‡ |

---

## 3. æ•°æ®æ¨¡å‹

### 3.1 æ–°å¢æ•°æ®è¡¨

```sql
-- ç”¨æˆ·çš„æ¨¡æ‹Ÿè·Ÿå•é…ç½®
CREATE TABLE copy_trading_config (
    id              BIGSERIAL PRIMARY KEY,
    user_fingerprint VARCHAR(120) NOT NULL,
    wallet_id       BIGINT NOT NULL REFERENCES wallet(id),
    enabled         BOOLEAN NOT NULL DEFAULT true,
    max_position_usdc NUMERIC(12,2) NOT NULL DEFAULT 1000,
    risk_preference VARCHAR(20) NOT NULL DEFAULT 'moderate',
    -- moderate / conservative / aggressive
    created_at      TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    UNIQUE(user_fingerprint, wallet_id)
);

-- Agent çš„æ¯ç¬”è·Ÿå•å†³ç­–è®°å½•
CREATE TABLE copy_trade_decision (
    id               BIGSERIAL PRIMARY KEY,
    config_id        BIGINT NOT NULL REFERENCES copy_trading_config(id),
    leader_trade_id  BIGINT REFERENCES trade_fill(id),
    market_id        BIGINT REFERENCES market(id),
    decision         VARCHAR(10) NOT NULL, -- copy / skip / close
    confidence       NUMERIC(4,3),
    outcome          VARCHAR(5),  -- Yes / No
    action           VARCHAR(5),  -- Buy / Sell
    price            NUMERIC(12,6),
    size_usdc        NUMERIC(12,2),
    stop_loss_price  NUMERIC(12,6),
    reasoning        TEXT,
    reasoning_en     TEXT,
    risk_notes       JSONB DEFAULT '[]',
    model_id         VARCHAR(50),
    input_tokens     INT,
    output_tokens    INT,
    latency_ms       INT,
    status           VARCHAR(20) NOT NULL DEFAULT 'pending',
    -- pending / executed / stopped / expired
    executed_at      TIMESTAMPTZ,
    closed_at        TIMESTAMPTZ,
    close_price      NUMERIC(12,6),
    realized_pnl     NUMERIC(12,4),
    created_at       TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
CREATE INDEX idx_ctd_config ON copy_trade_decision(config_id);
CREATE INDEX idx_ctd_status ON copy_trade_decision(status);

-- æ¯æ—¥è·Ÿå•ç»©æ•ˆæ±‡æ€»ï¼ˆæŒ‰ config ç»´åº¦ï¼‰
CREATE TABLE copy_trade_daily_perf (
    config_id       BIGINT NOT NULL REFERENCES copy_trading_config(id),
    perf_date       DATE NOT NULL,
    total_copies    INT NOT NULL DEFAULT 0,
    profitable      INT NOT NULL DEFAULT 0,
    total_pnl       NUMERIC(12,4) NOT NULL DEFAULT 0,
    total_exposure  NUMERIC(12,2) NOT NULL DEFAULT 0,
    skipped         INT NOT NULL DEFAULT 0,
    created_at      TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    PRIMARY KEY (config_id, perf_date)
);
```

### 3.2 Go Model å®šä¹‰

```go
type CopyTradingConfig struct {
    ID               int64     `gorm:"primaryKey" json:"id"`
    UserFingerprint  string    `gorm:"size:120;uniqueIndex:idx_ctc_user_wallet" json:"user_fingerprint"`
    WalletID         int64     `gorm:"uniqueIndex:idx_ctc_user_wallet" json:"wallet_id"`
    Enabled          bool      `gorm:"default:true" json:"enabled"`
    MaxPositionUSDC  float64   `gorm:"type:numeric(12,2);default:1000" json:"max_position_usdc"`
    RiskPreference   string    `gorm:"size:20;default:moderate" json:"risk_preference"`
    CreatedAt        time.Time `json:"created_at"`
    UpdatedAt        time.Time `json:"updated_at"`
}

type CopyTradeDecision struct {
    ID              int64          `gorm:"primaryKey" json:"id"`
    ConfigID        int64          `gorm:"index" json:"config_id"`
    LeaderTradeID   *int64         `json:"leader_trade_id,omitempty"`
    MarketID        *int64         `json:"market_id,omitempty"`
    Decision        string         `gorm:"size:10" json:"decision"`
    Confidence      float64        `json:"confidence"`
    Outcome         string         `gorm:"size:5" json:"outcome"`
    Action          string         `gorm:"size:5" json:"action"`
    Price           float64        `json:"price"`
    SizeUSDC        float64        `gorm:"type:numeric(12,2)" json:"size_usdc"`
    StopLossPrice   *float64       `json:"stop_loss_price,omitempty"`
    Reasoning       string         `json:"reasoning"`
    ReasoningEn     string         `json:"reasoning_en"`
    RiskNotes       datatypes.JSON `gorm:"type:jsonb;default:'[]'" json:"risk_notes"`
    ModelID         string         `gorm:"size:50" json:"model_id"`
    InputTokens     int            `json:"input_tokens"`
    OutputTokens    int            `json:"output_tokens"`
    LatencyMS       int            `json:"latency_ms"`
    Status          string         `gorm:"size:20;default:pending" json:"status"`
    ExecutedAt      *time.Time     `json:"executed_at,omitempty"`
    ClosedAt        *time.Time     `json:"closed_at,omitempty"`
    ClosePrice      *float64       `json:"close_price,omitempty"`
    RealizedPnL     *float64       `json:"realized_pnl,omitempty"`
    CreatedAt       time.Time      `json:"created_at"`
}

type CopyTradeDailyPerf struct {
    ConfigID       int64     `gorm:"primaryKey" json:"config_id"`
    PerfDate       time.Time `gorm:"primaryKey;type:date" json:"perf_date"`
    TotalCopies    int       `json:"total_copies"`
    Profitable     int       `json:"profitable"`
    TotalPnL       float64   `gorm:"type:numeric(12,4)" json:"total_pnl"`
    TotalExposure  float64   `gorm:"type:numeric(12,2)" json:"total_exposure"`
    Skipped        int       `json:"skipped"`
    CreatedAt      time.Time `json:"created_at"`
}
```

---

## 4. åç«¯æ¶æ„

### 4.1 æ¨¡å—åˆ’åˆ†

```
backend/internal/
â”œâ”€â”€ copytrade/
â”‚   â”œâ”€â”€ agent.go          # CopyTradeAgent â€” Nova Agent è°ƒç”¨å°è£…
â”‚   â”œâ”€â”€ service.go        # CopyTradeService â€” ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ repository.go     # CopyTradeRepository â€” æ•°æ®æŒä¹…åŒ–
â”œâ”€â”€ worker/
â”‚   â””â”€â”€ copy_trade_syncer.go  # CopyTradeSyncer â€” å®šæ—¶æ‰«ææ–°äº¤æ˜“å¹¶è§¦å‘ Agent
```

### 4.2 CopyTradeAgentï¼ˆAI Agent æ ¸å¿ƒï¼‰

```go
// agent.go
type CopyTradeAgent struct {
    analyzer ai.Analyzer  // å¤ç”¨ç°æœ‰ Bedrock/Nova å®¢æˆ·ç«¯
}

type CopyTradeSignal struct {
    LeaderWallet   LeaderContext
    NewTrade       TradeContext
    UserSettings   UserSettingsContext
    CopyHistory    CopyHistoryContext
}

type CopyTradeDecisionOutput struct {
    Decision      string   // "copy" | "skip" | "close"
    Confidence    float64
    PositionUSDC  float64
    PositionPct   float64
    Reasoning     string
    ReasoningEn   string
    RiskNotes     []string
    StopLossPrice *float64
    ModelID       string
    InputTokens   int
    OutputTokens  int
    LatencyMS     int
}

func (a *CopyTradeAgent) Evaluate(ctx context.Context, signal CopyTradeSignal) (*CopyTradeDecisionOutput, error)
```

### 4.3 CopyTradeService

```go
// service.go
type CopyTradeService struct {
    configRepo   *CopyTradeRepository
    tradeRepo    *repository.TradeRepository
    walletRepo   *repository.WalletRepository
    scoreRepo    *repository.ScoreRepository
    featureRepo  *repository.FeatureRepository
    agent        *CopyTradeAgent
}

// é…ç½®ç®¡ç†
func (s *CopyTradeService) EnableCopyTrading(ctx, userFP, walletID, maxPosition, riskPref) (*Config, error)
func (s *CopyTradeService) DisableCopyTrading(ctx, userFP, walletID) error
func (s *CopyTradeService) UpdateSettings(ctx, userFP, walletID, settings) (*Config, error)
func (s *CopyTradeService) GetConfig(ctx, userFP, walletID) (*Config, error)
func (s *CopyTradeService) ListConfigs(ctx, userFP) ([]ConfigView, error)

// Agent å†³ç­–
func (s *CopyTradeService) ProcessNewTrade(ctx, configID, leaderTradeID) (*Decision, error)

// ç»©æ•ˆæŸ¥è¯¢
func (s *CopyTradeService) GetPerformance(ctx, userFP, walletID) (*PerformanceView, error)
func (s *CopyTradeService) ListDecisions(ctx, userFP, walletID, page, pageSize) (*DecisionListResult, error)
func (s *CopyTradeService) GetDashboard(ctx, userFP) (*DashboardView, error)

// æŒä»“ç®¡ç†
func (s *CopyTradeService) ClosePosition(ctx, decisionID) (*Decision, error)
func (s *CopyTradeService) ListOpenPositions(ctx, userFP) ([]OpenPositionView, error)
```

### 4.4 CopyTradeSyncerï¼ˆWorkerï¼‰

```go
// copy_trade_syncer.go â€” å®šæ—¶æ‰«æå¹¶è§¦å‘ Agent
type CopyTradeSyncer struct {
    copyTradeService *copytrade.CopyTradeService
    tradeRepo        *repository.TradeRepository
    interval         time.Duration
}

func (s *CopyTradeSyncer) RunOnce(ctx context.Context) error {
    // 1. æŸ¥è¯¢æ‰€æœ‰ enabled çš„ copy_trading_config
    // 2. å¯¹æ¯ä¸ª configï¼ŒæŸ¥è¯¢ leader wallet çš„æ–°äº¤æ˜“ï¼ˆè‡ªä¸Šæ¬¡æ£€æŸ¥ä»¥æ¥ï¼‰
    // 3. å¯¹æ¯ç¬”æ–°äº¤æ˜“è°ƒç”¨ Agent å†³ç­–
    // 4. è®°å½•å†³ç­–ç»“æœ
    // 5. æ£€æŸ¥å·²æœ‰æŒä»“çš„å¸‚åœºç»“ç®—çŠ¶æ€ï¼Œè‡ªåŠ¨ç»“ç®—å·²ç»“æŸçš„æŒä»“
}
```

### 4.5 API ç«¯ç‚¹

```
POST   /api/v1/copy-trading/enable          # å¼€å¯å¯¹æŸé’±åŒ…çš„ AI è·Ÿå•
POST   /api/v1/copy-trading/disable         # å…³é—­è·Ÿå•
PUT    /api/v1/copy-trading/settings        # æ›´æ–°è·Ÿå•å‚æ•°
GET    /api/v1/copy-trading/configs         # ç”¨æˆ·æ‰€æœ‰è·Ÿå•é…ç½®
GET    /api/v1/copy-trading/:wallet_id      # æŸé’±åŒ…çš„è·Ÿå•è¯¦æƒ…

GET    /api/v1/copy-trading/dashboard       # è·Ÿå•æ€»è§ˆä»ªè¡¨ç›˜
GET    /api/v1/copy-trading/:wallet_id/decisions  # å†³ç­–è®°å½•ï¼ˆåˆ†é¡µï¼‰
GET    /api/v1/copy-trading/:wallet_id/performance  # ç»©æ•ˆæ›²çº¿
GET    /api/v1/copy-trading/positions       # æ‰€æœ‰æ¨¡æ‹ŸæŒä»“

POST   /api/v1/copy-trading/decisions/:id/close  # æ‰‹åŠ¨å¹³ä»“
```

---

## 5. å‰ç«¯è®¾è®¡

### 5.1 æ–°å¢é¡µé¢

#### `/copy-trading` â€” è·Ÿå•ä»ªè¡¨ç›˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI è·Ÿå•ä»ªè¡¨ç›˜                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æ€» PnL: +$185.30]  [èƒœç‡: 68%]  [è¿›è¡Œä¸­: 3]    â”‚
â”‚  [å·²è·Ÿå•: 45 ç¬”]     [å·²è·³è¿‡: 12 ç¬”]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€ PnL æ›²çº¿ï¼ˆå¤ç”¨ PnLChart ç»„ä»¶ï¼‰â”€â”€â”€â”          â”‚
â”‚  â”‚        ğŸ“ˆ                           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                   â”‚
â”‚  æ­£åœ¨è·Ÿå•çš„é’±åŒ…                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  #1  0x1234..abcd  â­ Star           â”‚         â”‚
â”‚  â”‚      ç­–ç•¥: event_trader  Score: 85   â”‚         â”‚
â”‚  â”‚      è·Ÿå• PnL: +$85.3  èƒœç‡: 73%    â”‚         â”‚
â”‚  â”‚      [è®¾ç½®]  [æš‚åœ]  [æŸ¥çœ‹è¯¦æƒ…]       â”‚         â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚  â”‚  #2  0x5678..efgh  ç­–ç•¥æ±             â”‚         â”‚
â”‚  â”‚      ç­–ç•¥: quant  Score: 72          â”‚         â”‚
â”‚  â”‚      è·Ÿå• PnL: +$100.0  èƒœç‡: 65%   â”‚         â”‚
â”‚  â”‚      [è®¾ç½®]  [æš‚åœ]  [æŸ¥çœ‹è¯¦æƒ…]       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                   â”‚
â”‚  æœ€è¿‘ Agent å†³ç­–                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  âœ… è·Ÿå• | Election Market Yes       â”‚         â”‚
â”‚  â”‚  $50 @ 0.42 | ç½®ä¿¡åº¦ 82%            â”‚         â”‚
â”‚  â”‚  "è¯¥é’±åŒ…åœ¨æ”¿æ²»ç±»äº‹ä»¶å¸‚åœºèƒœç‡ 73%..." â”‚         â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚  â”‚  â­ï¸ è·³è¿‡ | Crypto Price Market       â”‚         â”‚
â”‚  â”‚  "å¸‚åœºæµåŠ¨æ€§ä¸è¶³ï¼Œé¢„æœŸæ»‘ç‚¹ >3%..."   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é’±åŒ…è¯¦æƒ…é¡µ â€” æ–°å¢ "AI è·Ÿå•" æŒ‰é’®

åœ¨ `AccountInfoCard` æ—è¾¹ï¼Œå¢åŠ  "AI è·Ÿå•" CTA æŒ‰é’®ã€‚ç‚¹å‡»åå¼¹å‡ºè®¾ç½®é¢æ¿ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼€å¯ AI è·Ÿå•                    â”‚
â”‚                                  â”‚
â”‚  æœ€å¤§æ¨¡æ‹Ÿä»“ä½:  [____] USDC      â”‚
â”‚  é£é™©åå¥½:      â—‹ ä¿å®ˆ â— ä¸­ç­‰ â—‹ æ¿€è¿› â”‚
â”‚                                  â”‚
â”‚  AI Agent å°†ä¼šï¼š                 â”‚
â”‚  â€¢ åˆ†æè¯¥é’±åŒ…çš„æ¯ç¬”æ–°äº¤æ˜“        â”‚
â”‚  â€¢ è‡ªåŠ¨å†³å®šæ˜¯å¦è·Ÿå•åŠä»“ä½        â”‚
â”‚  â€¢ ç»™å‡ºæ¯ç¬”å†³ç­–çš„è‡ªç„¶è¯­è¨€ç†ç”±    â”‚
â”‚                                  â”‚
â”‚  [ç¡®è®¤å¼€å¯]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 æ–°å¢ç»„ä»¶

| ç»„ä»¶ | ç±»å‹ | ä½ç½® | è¯´æ˜ |
|------|------|------|------|
| `CopyTradeDashboard` | Server | `components/copytrade/` | è·Ÿå•ä»ªè¡¨ç›˜ä¸»ç»„ä»¶ |
| `CopyTradeToggle` | Client | `components/copytrade/` | å¼€å¯/å…³é—­è·Ÿå•æŒ‰é’® |
| `CopyTradeSettings` | Client | `components/copytrade/` | è·Ÿå•å‚æ•°è®¾ç½®é¢æ¿ |
| `DecisionFeed` | Server | `components/copytrade/` | Agent å†³ç­–è®°å½•åˆ—è¡¨ |
| `DecisionCard` | Server | `components/copytrade/` | å•æ¡å†³ç­–å¡ç‰‡ï¼ˆè·Ÿå•/è·³è¿‡ï¼‰ |
| `CopyPerfChart` | Client | `components/copytrade/` | è·Ÿå•ç»©æ•ˆæ›²çº¿ |
| `OpenPositions` | Server | `components/copytrade/` | å½“å‰æ¨¡æ‹ŸæŒä»“åˆ—è¡¨ |

### 5.3 æ–°å¢ TypeScript ç±»å‹

```typescript
type CopyTradingConfig = {
  id: number;
  wallet_id: number;
  enabled: boolean;
  max_position_usdc: number;
  risk_preference: "conservative" | "moderate" | "aggressive";
  created_at: string;
  updated_at: string;
};

type CopyTradeDecision = {
  id: number;
  config_id: number;
  decision: "copy" | "skip" | "close";
  confidence: number;
  outcome?: string;
  action?: string;
  market_title?: string;
  price: number;
  size_usdc: number;
  stop_loss_price?: number;
  reasoning: string;
  reasoning_en: string;
  risk_notes: string[];
  status: "pending" | "executed" | "stopped" | "expired";
  realized_pnl?: number;
  created_at: string;
};

type CopyTradeDashboard = {
  total_pnl: number;
  win_rate: number;
  total_copies: number;
  total_skipped: number;
  active_configs: number;
  open_positions: number;
  configs: CopyTradingConfigView[];
  recent_decisions: CopyTradeDecision[];
};

type CopyTradePerformance = {
  daily_points: { date: string; pnl: number; copies: number }[];
  total_pnl: number;
  win_rate: number;
  total_copies: number;
  best_trade_pnl: number;
  worst_trade_pnl: number;
};
```

---

## 6. Amazon Nova é›†æˆç»†èŠ‚

### 6.1 æ¨¡å‹é€‰æ‹©

| åœºæ™¯ | æ¨èæ¨¡å‹ | ç†ç”± |
|------|---------|------|
| é€ç¬”äº¤æ˜“å†³ç­– | Nova Micro / Nova Lite | ä½å»¶è¿Ÿï¼ˆ< 1sï¼‰ï¼Œæˆæœ¬ä½ï¼Œé€‚åˆé«˜é¢‘è°ƒç”¨ |
| æ¯æ—¥ç»©æ•ˆæ€»ç»“ | Nova Pro | æ›´å¼ºçš„åˆ†æèƒ½åŠ›ï¼Œç”Ÿæˆè´¨é‡æ›´é«˜çš„æ€»ç»“ |
| å¼‚å¸¸æ£€æµ‹æŠ¥å‘Š | Nova Pro | éœ€è¦ç†è§£å¤æ‚ä¸Šä¸‹æ–‡å¹¶ç”Ÿæˆé£æ§å»ºè®® |

### 6.2 Prompt è®¾è®¡

**System Promptï¼ˆè·Ÿå•å†³ç­–ï¼‰**ï¼š

```
You are a Polymarket copy-trading AI agent. Your job is to decide whether
to copy a leader wallet's trade based on the following criteria:

DECISION FRAMEWORK:
1. Leader Quality: Consider smart_score, win_rate, strategy consistency
2. Trade Quality: Consider market liquidity, category match with leader's expertise
3. Risk Management: Respect user's max position and risk preference
4. Portfolio Context: Consider existing exposure and diversification

RISK PREFERENCE GUIDE:
- conservative: Only copy high-confidence trades (>0.8), max 10% per trade
- moderate: Copy medium+ confidence trades (>0.6), max 20% per trade
- aggressive: Copy most trades (>0.4), max 30% per trade

Return ONLY valid JSON with this schema:
{
  "decision": "copy" | "skip",
  "confidence": 0.0-1.0,
  "position_size_usdc": number (0 if skip),
  "reasoning": "ä¸­æ–‡å†³ç­–ç†ç”±",
  "reasoning_en": "English reasoning",
  "risk_notes": ["string"],
  "stop_loss_price": number | null
}
```

### 6.3 è°ƒç”¨é¢‘ç‡ä¸æˆæœ¬ä¼°ç®—

å‡è®¾ï¼š
- å¹³å‡æ¯ä¸ªé¢†æŠ•é’±åŒ…æ¯å¤© 5 ç¬”äº¤æ˜“
- ç”¨æˆ·å¹³å‡è·Ÿå• 3 ä¸ªé’±åŒ…
- æ¯æ¬¡ Agent è°ƒç”¨çº¦ 500 input tokens + 200 output tokens

æ¯ç”¨æˆ·æ¯å¤©ï¼š15 æ¬¡è°ƒç”¨ Ã— 700 tokens â‰ˆ 10,500 tokens/day

Nova Micro å®šä»·ï¼ˆçº¦ $0.035/1M input + $0.14/1M outputï¼‰ï¼š
- æ¯ç”¨æˆ·æ¯å¤©æˆæœ¬ â‰ˆ $0.0007ï¼ˆå¯å¿½ç•¥ï¼‰

---

## 7. å®ç°è·¯çº¿å›¾

### Phase 1: åŸºç¡€è®¾æ–½ï¼ˆé¢„è®¡ 1-2 å¤©ï¼‰

- [ ] åˆ›å»ºæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼ˆ3 å¼ æ–°è¡¨ï¼‰
- [ ] åˆ›å»º Go Model å®šä¹‰
- [ ] åˆ›å»º CopyTradeRepositoryï¼ˆCRUD æ“ä½œï¼‰
- [ ] åˆ›å»º CopyTradeAgentï¼ˆNova Agent è°ƒç”¨å°è£…ï¼‰

### Phase 2: æœåŠ¡ä¸ APIï¼ˆé¢„è®¡ 1-2 å¤©ï¼‰

- [ ] åˆ›å»º CopyTradeServiceï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
- [ ] åˆ›å»º API Handlersï¼ˆ7 ä¸ªç«¯ç‚¹ï¼‰
- [ ] æ³¨å†Œè·¯ç”±
- [ ] åˆ›å»º CopyTradeSyncer Worker

### Phase 3: å‰ç«¯ç±»å‹ä¸ APIï¼ˆé¢„è®¡åŠå¤©ï¼‰

- [ ] æ·»åŠ  TypeScript ç±»å‹
- [ ] æ·»åŠ  API Client å‡½æ•°
- [ ] æ·»åŠ  i18n ç¿»è¯‘ keys

### Phase 4: å‰ç«¯ç»„ä»¶ä¸é¡µé¢ï¼ˆé¢„è®¡ 1-2 å¤©ï¼‰

- [ ] CopyTradeToggle ç»„ä»¶ï¼ˆé’±åŒ…è¯¦æƒ…é¡µçš„å¼€å¯è·Ÿå•æŒ‰é’®ï¼‰
- [ ] CopyTradeSettings é¢æ¿
- [ ] CopyTradeDashboard é¡µé¢
- [ ] DecisionFeed + DecisionCard ç»„ä»¶
- [ ] CopyPerfChart ç»©æ•ˆæ›²çº¿
- [ ] OpenPositions æŒä»“åˆ—è¡¨

### Phase 5: é›†æˆæµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆé¢„è®¡ 1 å¤©ï¼‰

- [ ] ç«¯åˆ°ç«¯æµ‹è¯•æµç¨‹
- [ ] Agent prompt è°ƒä¼˜
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆWorker é—´éš”ã€æ‰¹å¤„ç†ï¼‰
- [ ] æš—è‰²/äº®è‰²ä¸»é¢˜é€‚é…

---

## 8. æŠ€æœ¯å†³ç­–è®°å½•

| å†³ç­– | é€‰æ‹© | ç†ç”± |
|------|------|------|
| æ¨¡æ‹Ÿ vs å®ç›˜ | æ¨¡æ‹Ÿä¼˜å…ˆ | é™ä½é£é™©ï¼Œç§¯ç´¯æ•°æ®éªŒè¯ Agent è´¨é‡ |
| Agent è°ƒç”¨æ—¶æœº | Worker å®šæ—¶è½®è¯¢ | ç®€å•å¯é ï¼Œå¤ç”¨ç°æœ‰ Worker æ¨¡å¼ |
| ä»“ä½è®¡ç®— | Agent å»ºè®® + è§„åˆ™æˆªæ–­ | Agent è´Ÿè´£æ™ºèƒ½åˆ†æï¼Œè§„åˆ™è´Ÿè´£ç¡¬æ€§é£æ§ |
| æŒä»“ç»“ç®— | å¸‚åœºç»“ç®—æ—¶è‡ªåŠ¨è®¡ç®— PnL | åŸºäº market.resolved_outcome |
| ç”¨æˆ·æ ‡è¯† | å¤ç”¨ fingerprint | ä¸€è‡´æ€§ï¼Œæ— éœ€æ–°å¢è®¤è¯ç³»ç»Ÿ |
| å†³ç­–å­˜å‚¨ | å…¨é‡è®°å½•ï¼ˆåŒ…æ‹¬è·³è¿‡ï¼‰ | ä¾¿äºåˆ†æ Agent è¡Œä¸ºå’Œç”¨æˆ·å¤ç›˜ |
| åŒè¯­æ”¯æŒ | Agent è¾“å‡ºä¸­è‹±æ–‡ reasoning | ä¿æŒäº§å“åŒè¯­ä¸€è‡´æ€§ |

---

## 9. é£é™©ä¸æŒ‘æˆ˜

| é£é™© | å½±å“ | ç¼“è§£æ–¹æ¡ˆ |
|------|------|---------|
| Nova API å»¶è¿ŸæŠ–åŠ¨ | å†³ç­–å»¶è¿Ÿ | è®¾ç½®è¶…æ—¶ + fallback åˆ°è§„åˆ™å¼•æ“ |
| Agent å†³ç­–è´¨é‡ä¸ç¨³å®š | ç”¨æˆ·ä¿¡ä»»å—æŸ | åˆæœŸä¿å®ˆç­–ç•¥ + é€æ­¥æ”¾å¼€ |
| æ¨¡æ‹Ÿ PnL ä¸å®ç›˜å·®å¼‚ | ç”¨æˆ·é¢„æœŸç®¡ç† | æ˜ç¡®æ ‡æ³¨"æ¨¡æ‹Ÿ"ï¼ŒåŠ å…¥æ»‘ç‚¹ä¼°ç®— |
| é«˜é¢‘äº¤æ˜“é’±åŒ… | Worker å¤„ç†å‹åŠ› | æ‰¹å¤„ç† + é¢‘ç‡é™åˆ¶ |
| ç”¨æˆ·æ»¥ç”¨ | èµ„æºæ¶ˆè€— | æ¯ç”¨æˆ·æœ€å¤šè·Ÿ 5 ä¸ªé’±åŒ…ï¼Œæ¯å¤© 100 æ¬¡ Agent è°ƒç”¨ä¸Šé™ |

---

## 10. æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| Agent å†³ç­–å‡†ç¡®ç‡ï¼ˆæ¨¡æ‹Ÿè·Ÿå• PnL > 0 çš„æ¯”ä¾‹ï¼‰ | > 55% |
| ç”¨æˆ·ä»"å…³æ³¨"å‡çº§åˆ°"AI è·Ÿå•"çš„è½¬åŒ–ç‡ | > 15% |
| æ¯æ—¥æ´»è·ƒè·Ÿå•ç”¨æˆ· | > 50 |
| Agent å¹³å‡å†³ç­–å»¶è¿Ÿ | < 2s |
| ç”¨æˆ·æ»¡æ„åº¦ï¼ˆé€šè¿‡è·Ÿå•ä»ªè¡¨ç›˜çš„ä½¿ç”¨æ—¶é•¿è¡¡é‡ï¼‰ | å¹³å‡ > 3 min/session |
